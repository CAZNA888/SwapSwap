# Полная инструкция по созданию префаба карточки

## Размеры: 368×512 пикселей

Ваши спрайты имеют размер **368×512 пикселей**. При `Pixels Per Unit = 100` это будет **3.68 × 5.12** мировых единиц Unity.

---

## ШАГ 1: Подготовка спрайтов

### 1.1 Настройка CardBack спрайта

1. Откройте Project window
2. Найдите CardBack спрайт в `Assets/Sprites/CardBack/`
3. Выберите его
4. В Inspector найдите секцию **Import Settings**:
   - **Texture Type**: `Sprite (2D and UI)`
   - **Pixels Per Unit**: `100` ⚠️ **ВАЖНО: должно быть 100!**
   - **Filter Mode**: `Bilinear`
   - **Compression**: `None` (для четкости)
5. Нажмите **Apply** внизу

**Результат:** Размер в мировых единицах = **3.68 × 5.12**

### 1.2 Настройка Border спрайта

1. Найдите Border спрайт в `Assets/Sprites/Borders/`
2. Выберите его
3. В Inspector:
   - **Texture Type**: `Sprite (2D and UI)`
   - **Pixels Per Unit**: `100` ⚠️ **Должно быть такое же как у CardBack!**
   - **Filter Mode**: `Bilinear`
   - **Compression**: `None`
4. Нажмите **Apply**

**Результат:** Размер в мировых единицах = **3.68 × 5.12**

---

## ШАГ 2: Создание GameObject

1. Откройте любую сцену (например, `SampleScene`)
2. В Hierarchy нажмите правой кнопкой → **Create Empty**
   - Или используйте `GameObject → Create Empty`
   - Или горячая клавиша: `Ctrl+Shift+N` (Windows) / `Cmd+Shift+N` (Mac)
3. Назовите объект: `PuzzlePiece`
4. Убедитесь, что Transform:
   - **Position**: (0, 0, 0)
   - **Rotation**: (0, 0, 0)
   - **Scale**: (1, 1, 1)

---

## ШАГ 3: Добавление скрипта настройки

1. Выберите `PuzzlePiece` в Hierarchy
2. В Inspector нажмите **Add Component**
3. В поиске введите: `Card Prefab Builder`
4. Выберите `Card Prefab Builder` (Scripts/Core/CardPrefabBuilder.cs)
5. Компонент добавится на объект

---

## ШАГ 4: Настройка CardPrefabBuilder

В Inspector компонента `Card Prefab Builder`:

### 4.1 Установка спрайтов

1. **Card Back Sprite**:

   - Перетащите CardBack спрайт из `Assets/Sprites/CardBack/` в это поле
   - Или нажмите на кружок справа и выберите спрайт

2. **Border Sprite**:
   - Перетащите Border спрайт из `Assets/Sprites/Borders/` в это поле
   - Или нажмите на кружок справа и выберите спрайт

### 4.2 Проверка размеров (опционально)

1. Правой кнопкой мыши на компоненте `Card Prefab Builder`
2. Выберите **Проверить размеры спрайтов**
3. Откройте Console (Window → General → Console)
4. Проверьте вывод:
   ```
   CardBack размер: 3.68 x 5.12 (мировых единиц)
   CardBack пиксели: 368 x 512
   Pixels Per Unit: 100
   ✓ Размеры правильные!
   ```

**Если размеры неправильные:**

- Вернитесь к ШАГ 1 и проверьте `Pixels Per Unit` (должно быть 100)
- Нажмите Apply на спрайте

---

## ШАГ 5: Автоматическая настройка

1. Правой кнопкой мыши на компоненте `Card Prefab Builder`
2. Выберите **1. Автоматическая настройка ВСЕГО**

### Что происходит:

Скрипт автоматически:

- ✓ Определяет размер карточки из CardBack (3.68 × 5.12)
- ✓ Добавляет и настраивает SpriteRenderer
- ✓ Добавляет и настраивает BoxCollider2D (размер 3.68 × 5.12)
- ✓ Добавляет и настраивает Rigidbody2D (Kinematic)
- ✓ **Разрезает рамку по двум диагоналям на 4 треугольника:**
  - Верхний треугольник → TopBorder (покрывает верхнюю половину)
  - Нижний треугольник → BottomBorder (покрывает нижнюю половину)
  - Левый треугольник → LeftBorder (покрывает левую половину)
  - Правый треугольник → RightBorder (покрывает правую половину)

### Проверка в Console:

Должны быть сообщения:

```
=== НАЧАЛО АВТОМАТИЧЕСКОЙ НАСТРОЙКИ ===
✓ Размер карточки определен: 3.68 x 5.12 единиц
✓ SpriteRenderer настроен
✓ BoxCollider2D настроен, размер: 3.68 x 5.12
✓ Rigidbody2D настроен (Kinematic)
Создание рамок, толщина: 0.184 единиц
  ✓ TopBorder создан...
  ✓ BottomBorder создан...
  ✓ LeftBorder создан...
  ✓ RightBorder создан...
✓ Рамки созданы и настроены
=== НАСТРОЙКА ЗАВЕРШЕНА ===
```

**Если есть ошибки** — исправьте их перед продолжением.

---

## ШАГ 6: Добавление компонента PuzzlePiece

1. Выберите `PuzzlePiece` в Hierarchy
2. **Add Component** → найдите `Puzzle Piece`
3. Добавьте компонент `Puzzle Piece` (Scripts/Core/PuzzlePiece.cs)
4. Пока ничего не настраивайте — будет настроено автоматически при игре

---

## ШАГ 7: Проверка структуры

В Hierarchy должна быть такая структура:

```
PuzzlePiece
├── Card Prefab Builder (Component)
├── Puzzle Piece (Component)
├── Sprite Renderer (Component)
├── Box Collider 2D (Component)
├── Rigidbody 2D (Component)
└── BorderContainer (GameObject)
    ├── Border Renderer (Component)
    ├── TopBorder (GameObject)
    │   └── Sprite Renderer
    ├── BottomBorder (GameObject)
    │   └── Sprite Renderer
    ├── LeftBorder (GameObject)
    │   └── Sprite Renderer
    └── RightBorder (GameObject)
        └── Sprite Renderer
```

---

## ШАГ 8: Визуальная проверка в Scene

1. Откройте Scene view (если не открыта)
2. Выберите `PuzzlePiece` в Hierarchy
3. В Scene view вы должны видеть:
   - ✅ Карточку (CardBack спрайт) размером 3.68 × 5.12
   - ✅ Рамки по всем 4 сторонам
   - ✅ Рамки точно покрывают карточку (как лист А4 на лист А4)

### Если рамки не видны:

1. Убедитесь, что Border Sprite установлен в CardPrefabBuilder
2. Правой кнопкой на CardPrefabBuilder → **2. Создать рамки**

### Если рамки неправильного размера:

1. Правой кнопкой на CardPrefabBuilder → **3. Удалить рамки**
2. Правой кнопкой на CardPrefabBuilder → **2. Создать рамки**

---

## ШАГ 9: Сохранение префаба

1. В Project window откройте папку `Assets/Prefabs/`

   - Если папки нет — создайте: правой кнопкой → Create → Folder → назовите `Prefabs`

2. Перетащите GameObject `PuzzlePiece` из Hierarchy в папку `Prefabs` в Project window

3. Unity создаст префаб (синий кубик в Project)

4. Удалите объект `PuzzlePiece` со сцены:
   - Выберите его в Hierarchy
   - Нажмите `Delete` или правой кнопкой → Delete

**Префаб останется в папке Prefabs!**

---

## ШАГ 10: Использование в GameManager

1. Найдите GameManager на сцене (или создайте его)
2. Выберите GameManager
3. В Inspector найдите поле **Puzzle Piece Prefab**
4. Перетащите префаб `PuzzlePiece` из `Assets/Prefabs/` в это поле

---

## Проверка размеров

### Ожидаемые значения:

После настройки у вас должно быть:

- **CardBack размер**: 3.68 × 5.12 единиц
- **BoxCollider2D Size**: 3.68 × 5.12
- **Рамки**:
  - Top/Bottom: ширина 3.68, высота ~0.184 (5% от 3.68)
  - Left/Right: ширина ~0.256 (5% от 5.12), высота 5.12

### Команды для проверки:

1. **Проверить размеры спрайтов** — показывает все размеры и проверяет правильность
2. **Показать размер карточки** — быстрая проверка размера
3. **1. Автоматическая настройка ВСЕГО** — полная настройка
4. **2. Создать рамки** — только создание рамок
5. **3. Удалить рамки** — удаление рамок

---

## Решение проблем

### Проблема: Спрайт меньше чем должен быть

**Причина:** Неправильный `Pixels Per Unit`

**Решение:**

1. Выберите спрайт в Project
2. Установите `Pixels Per Unit = 100`
3. Нажмите Apply
4. Перезапустите настройку префаба

### Проблема: Рамки не создаются

**Причина:** Border Sprite не установлен

**Решение:**

1. Установите Border Sprite в CardPrefabBuilder
2. Правой кнопкой → **2. Создать рамки**

### Проблема: Рамки не покрывают карточку

**Причина:** Разные Pixels Per Unit у CardBack и Border

**Решение:**

1. Убедитесь, что оба спрайта имеют `Pixels Per Unit = 100`
2. Удалите рамки (команда 3)
3. Создайте заново (команда 2)

### Проблема: Размеры не совпадают с ожидаемыми

**Проверка:**

1. Правой кнопкой → **Проверить размеры спрайтов**
2. Смотрите в Console что не так
3. Исправьте `Pixels Per Unit` если нужно

---

## Готово!

Префаб создан и готов к использованию. При создании карточек в игре:

- Размер будет автоматически 3.68 × 5.12 (из CardBack)
- Рамки будут точно покрывать карточку
- Все компоненты настроены правильно

---

## Быстрая справка

**Размеры:**

- Пиксели: 368 × 512
- Мировые единицы (при Pixels Per Unit = 100): 3.68 × 5.12
- Соотношение: 0.72:1 (примерно 9:12.5)

**Команды CardPrefabBuilder:**

1. `1. Автоматическая настройка ВСЕГО` — полная настройка
2. `2. Создать рамки` — только рамки
3. `3. Удалить рамки` — удаление рамок
4. `Проверить размеры спрайтов` — диагностика
5. `Показать размер карточки` — быстрая проверка
